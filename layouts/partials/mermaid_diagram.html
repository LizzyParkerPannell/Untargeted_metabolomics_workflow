{{ partial "shortcodes/mermaid.html" (dict
  "context" .
  "content" "graph TD\nsubgraph S01[ ]\ntitle_S01[Stage 1 - Metabolite Extraction]\nA{Plants or bacteria} -->|Plants| B[\Quenching, extraction & phase separation/]\nA --> |Bacteria| C[\Growth & isolation of cells/] --> B\nclassDef red fill:#D53E4F, stroke:#D53E4F;\nclass A,B,C red;\nend\nsubgraph S02[ ]\ntitle_S02[Stage 2 - Data Acquisition]\nD{Which MS?} --> E[MALDI]\nD --> F[DI-ESI-MS]\nD --> G[LC-ESI-MS]\nD --> H[GC-ESI-MS] --> I>Standardized GCMS workflow]\nE --> J[/.RAW files from MassLynx/]\nF --> J\nG --> J\nclassDef orange fill:#F46D43, stroke:#F46D43;\nclass D,E,F,G,H,I,J orange;\nend\nB --> D\nsubgraph S03[ ]\ntitle_S03[Stage 3 - Data conversion to open format]\nK[Convert data\n Proteowizard > MSConvert\n * scanEvent\n * polarity]-->|MALDI|N[/.mzML open format\n profile/]\nL[Convert & compress data\n Proteowizard > MSConvert\n * Scan range\n * scanEvent\n * polarity]-->|DI-ESI-MS|O[/.mzML open format\n profile, selected scans/]\nM[Convert & compress data\n Proteowizard > MSConvert\n * peakPicking\n * scanEvent\n * polarity]-->|LC-ESI-MS|P[/.mzML open format\n centroid/]\nclick K "https://untargeted-metabolomics-workflow.netlify.app/03_conversion-to-open-format/02_msconvert-maldi/" _blank\nclick L "https://untargeted-metabolomics-workflow.netlify.app/03_conversion-to-open-format/04_msconvert-dims/" _blank\nclick M "https://untargeted-metabolomics-workflow.netlify.app/03_conversion-to-open-format/03_msconvert-lcms/" _blank\nclassDef pale_orange fill:#FDAE61, stroke:#FDAE61;\nclass K,L,M,N,O,P pale_orange;\nend\nJ -->|MALDI|K\nJ -->|DI-ESI-MS|L\nJ -->|LC-ESI-MS|M\nsubgraph S04[ ]\ntitle_S04[Stage 4 - Data preprocessing]\nQ[MassUp or R to run\n MALDIquant\nbaseline correction, normalization, alignment, peak detection]\nR[XCMSonline or R to run\n XCMS\nPeak picking, RT correction, alignment, grouping]\nclassDef yellow fill:#FEE08B, stroke:#FEE08B;\nclass Q,R yellow;\nclick Q "https://untargeted-metabolomics-workflow.netlify.app/04_data-preprocessing/02_processing-maldi/" _blank\nclick R "https://untargeted-metabolomics-workflow.netlify.app/04_data-preprocessing/03_processing-lcms/" _blank\nend\nN & O --> Q\nP --> R\nsubgraph S05[ ]\ntitle_S05[Stage 5 - Extract & format peak table & metadata]\nS[Download each sample's .csv\n and tidy in R] --> U[/.csv peak table\n samples as rows, m.z as columns/]\nT[Download results folder\n and tidy in R] --> U\nU --- V[/.csv metadata\n sample, independent variable1 .../]\nclassDef pale_yellow fill:#E6F598, stroke:#E6F598;\nclass S,T,U,V pale_yellow;\nclick S "https://untargeted-metabolomics-workflow.netlify.app/05_extracting-formatting-peak-table/02_peak-table_massup/" _blank\nclick T "https://untargeted-metabolomics-workflow.netlify.app/05_extracting-formatting-peak-table/03_peak-table_xcmsonline/" _blank\nend\nQ --> S\nR --> T\nsubgraph S06[ ]\ntitle_S06[Stage 6 - Multivariate analysis]\ndirection TB\nW{Open source, online, \nlocal and/or proprietary?} -->|Open source\nlocal\nversion control with git|S09(pcaMethods & muma\n using R & RStudio)\nW -->|Open source\nonline\nsense checks|S10(Metaboanalyst)\nW -->|Proprietary\nlocal|S11(Proprietary software\n e.g. SIMCA by Umetrics)\nclick S09 "https://untargeted-metabolomics-workflow.netlify.app/06_multivariate-analysis/03_r-for-pca-and-oplsda/" _blank\nclick S10 "https://untargeted-metabolomics-workflow.netlify.app/06_multivariate-analysis/02_metaboanalyst/" _blank\nclassDef pale_green fill:#ABDDA4, stroke:#ABDDA4;\nclassDef empty_pale_green fill:honeydew, stroke:#ABDDA4;\nclass W pale_green;\nclass S09,S10,S11 empty_pale_green;\nsubgraph S12[ ]\ndirection TB\nA1[Load data and metadata] --> A2[Scaling & normalization] --> A3[Exploratory analysis\n PCA, PERMANOVA & interpretation] --> A4[Directed analysis where appropriate\n OPLS-DA & detailed stats]\nA4 --> A5[/List of features of interest\nm/z or m/z with RT/]\nA3 & A4 --> A6>Graphs & stats for reporting]\nclass A1,A2,A3,A4,A5,A6 pale_green;\nend\nS09 & S10 & S11 --> A1\nend\nV --> W\nsubgraph S07[ ]\ntitle_S07[Stage 7 - Putative metabolite identification]\nX[Use features of interest\n to search databases/repositories and literature\n e.g. METLIN, KEGG, PubChem, Cyc, MassBank]\nX --> Y[/Putative identities of metabolites\n responsible for differences between classes/]\nY --> Z>Further MS to confirm IDs\n targeted, tandem or NMR] & Z1>Pathway analysis, enrichment analysis]\nclassDef green fill:#66C2A5, stroke:#66C2A5;\nclass X,Y,Z,Z1 green\nclick X "https://untargeted-metabolomics-workflow.netlify.app/07_putative-metabolite-id/" _blank\nend\nA5 --> X\nsubgraph S08[ ]\ntitle_S08[Stage 8 - Data archiving and reporting]\nB1{{Prepare data for\n submission to repository}} --> B2[Submit data to MetaboLights]\nY & U & V & J -.-> B1\nB2 --> B3[Remember to cite tools used]\nclassDef blue fill:#3288BD, stroke:#3288BD;\nclass B1,B2,B3 blue\nclick B1 "https://untargeted-metabolomics-workflow.netlify.app/08_data-archiving-citation/02_metabolights/" _blank\nclick B2 "https://www.ebi.ac.uk/training/online/courses/metabolights-quick-tour/submitting-data-to-metabolights/" _blank\nend\n%% defining subgraph title node styling\nstyle title_S01 fill:white, stroke:#D53E4F, stroke-width:4;\nstyle title_S02 fill:white, stroke:#F46D43, stroke-width:4;\nstyle title_S03 fill:white, stroke:#FDAE61, stroke-width:4;\nstyle title_S04 fill:white, stroke:#FEE08B, stroke-width:4;\nstyle title_S05 fill:white, stroke:#E6F598, stroke-width:4;\nstyle title_S06 fill:white, stroke:#ABDDA4, stroke-width:4;\nstyle title_S07 fill:white, stroke:#66C2A5, stroke-width:4;\nstyle title_S08 fill:white, stroke:#3288BD, stroke-width:4;\n%% adding URL links (subgraph titles)\nclick title_S01 "https://untargeted-metabolomics-workflow.netlify.app/01_metabolite-extraction/" _blank\nclick title_S02 "https://untargeted-metabolomics-workflow.netlify.app/02_data-acquisition/" _blank\nclick title_S03 "https://untargeted-metabolomics-workflow.netlify.app/03_conversion-to-open-format/" _blank\nclick title_S04 "https://untargeted-metabolomics-workflow.netlify.app/04_data-preprocessing/" _blank\nclick title_S05 "https://untargeted-metabolomics-workflow.netlify.app/05_extracting-formatting-peak-table/" _blank\nclick title_S06 "https://untargeted-metabolomics-workflow.netlify.app/06_multivariate-analysis/" _blank\nclick title_S07 "https://untargeted-metabolomics-workflow.netlify.app/07_putative-metabolite-id/" _blank\nclick title_S08 "https://untargeted-metabolomics-workflow.netlify.app/08_data-archiving-citation/" _blank\n%% defining subgraph styling\nclassDef subgraphstyle fill:white, stroke:white, stroke-width:0;\nclass S01,S02,S03,S04,S05,S06,S07,S08,S12 subgraphstyle;"
  "align"   "center"
)}}
